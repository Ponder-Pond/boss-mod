#!/usr/bin/env python3

import os
import subprocess
import shutil

ROM = "ver/current/build/papermario.z64"
EMULATOR_PATHS = [
    "cen64",
    "ares",
    "mupen64plus",
    "retroarch",
    "Project64",
]
emulator = None

for command in EMULATOR_PATHS:
    if shutil.which(command) is not None:
        emulator = command
        break

    # WSl compat
    command += ".exe"
    if shutil.which(command) is not None:
        emulator = command
        break

def main():
    if os.system(f"ninja {ROM}") != 0:
        print("Build failed")
        return

    if emulator is not None:
        subprocess.run([emulator, ROM])
    else:
        print("No emulator found")

if __name__ == "__main__":
    main()
